{"version":3,"file":"static/js/1264.11662c1b.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/views/interactive/snapping/featureSources/sceneLayerSource/sceneLayerSnappingUtils.js","../node_modules/@arcgis/core/views/interactive/snapping/featureSources/sceneLayerSource/SceneLayerSnappingSourceWorker.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.29/esri/copyright.txt for details.\n*/\nimport{r as s,q as r,g as o}from\"../../../../../chunks/vec32.js\";import{c,g as n}from\"../../../../../chunks/sphere.js\";const t=1e3;function e(t,e,a){const m=c(),p=n(m);return s(p,p,t,.5),s(p,p,e,.5),m[3]=r(p,t),o(p,p,a),m}export{e as boundsFromEdge,t as maxCandidateCount};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.29/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import{throwIfAborted as t}from\"../../../../../core/promiseUtils.js\";import\"../../../../../core/Logger.js\";import\"../../../../../core/has.js\";import\"../../../../../core/RandomLCG.js\";import\"../../../../../core/Error.js\";import{subclass as o}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{g as s,q as n}from\"../../../../../chunks/vec32.js\";import{create as i,clone as r}from\"../../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{create as d,fromPoints as c,projectPoint as a}from\"../../../../../geometry/support/lineSegment.js\";import{g as p,n as m}from\"../../../../../chunks/sphere.js\";import h from\"../../../../3d/webgl-engine/lib/Octree.js\";import{extractComponentsEdgeLocationsLayout as u}from\"../../../../3d/webgl-engine/lib/edgeRendering/edgeProcessing.js\";import{maxCandidateCount as g,boundsFromEdge as l}from\"./sceneLayerSnappingUtils.js\";let _=class{constructor(){this._idToComponent=new Map,this._components=new h((e=>e.bounds)),this._edges=new h((e=>e.bounds)),this._tmpLineSegment=d(),this._tmpP1=i(),this._tmpP2=i(),this._tmpP3=i(),this.remoteClient=null}async fetchCandidates(e,o){await Promise.resolve(),t(o),await this._ensureEdgeLocations(e,o);const s=[];return this._edges.forEachNeighbor((t=>(this._addCandidates(e,t,s),s.length<g)),e.bounds),{result:{candidates:s}}}async _ensureEdgeLocations(e,t){const o=[];if(this._components.forEachNeighbor((e=>{if(null==e.info){const{id:t,uid:s}=e;o.push({id:t,uid:s})}return!0}),e.bounds),!o.length)return;const s={components:o},n=await this.remoteClient.invoke(\"fetchAllEdgeLocations\",s,t??{});for(const i of n.components)this._setFetchEdgeLocations(i)}async add(e){const t=new b(e.id,e.bounds);return this._idToComponent.set(t.id,t),this._components.add([t]),{result:{}}}async remove(e){const t=this._idToComponent.get(e.id);if(t){const e=[];this._edges.forEachNeighbor((o=>(o.component===t&&e.push(o),!0)),t.bounds),this._edges.remove(e),this._components.remove([t]),this._idToComponent.delete(t.id)}return{result:{}}}_setFetchEdgeLocations(e){const t=this._idToComponent.get(e.id);if(null==t||e.uid!==t.uid)return;const o=u.createView(e.locations),s=new Array(o.count),n=i(),r=i();for(let i=0;i<o.count;i++){o.position0.getVec(i,n),o.position1.getVec(i,r);const d=l(n,r,e.origin),c=new j(t,i,d);s[i]=c}this._edges.add(s);const{objectIds:d,origin:c}=e;t.info={locations:o,objectIds:d,origin:c}}_addCandidates(e,t,o){const{info:n}=t.component,{origin:i,objectIds:r}=n,d=n.locations,c=d.position0.getVec(t.index,this._tmpP1),a=d.position1.getVec(t.index,this._tmpP2);s(c,c,i),s(a,a,i);const p=r[d.componentIndex.get(t.index)];this._addEdgeCandidate(e,p,c,a,o),this._addVertexCandidate(e,p,c,o),this._addVertexCandidate(e,p,a,o)}_addEdgeCandidate(e,t,o,s,i){if(!e.returnEdge)return;const d=p(e.bounds),h=c(o,s,this._tmpLineSegment),u=a(h,d,this._tmpP3);m(e.bounds,u)&&i.push({type:\"edge\",objectId:t,target:r(u),distance:n(d,u),start:r(o),end:r(s)})}_addVertexCandidate(e,t,o,s){if(!e.returnVertex||!m(e.bounds,o))return;const i=p(e.bounds);s.push({type:\"vertex\",objectId:t,target:r(o),distance:n(i,o)})}};_=e([o(\"esri.views.interactive.snapping.featureSources.sceneLayerSource.SceneLayerSnappingSourceWorker\")],_);const f=_;class b{constructor(e,t){this.id=e,this.bounds=t,this.info=null,this.uid=++b.uid}}b.uid=0;class j{constructor(e,t,o){this.component=e,this.index=t,this.bounds=o}}export{f as default};\n"],"names":["e","t","a","m","c","p","n","s","r","o","_","constructor","this","_idToComponent","Map","_components","h","bounds","_edges","_tmpLineSegment","d","_tmpP1","i","_tmpP2","_tmpP3","remoteClient","fetchCandidates","Promise","resolve","_ensureEdgeLocations","forEachNeighbor","_addCandidates","length","result","candidates","info","id","uid","push","components","invoke","_setFetchEdgeLocations","add","b","set","remove","get","component","delete","u","createView","locations","Array","count","position0","getVec","position1","l","origin","j","objectIds","index","componentIndex","_addEdgeCandidate","_addVertexCandidate","returnEdge","type","objectId","target","distance","start","end","returnVertex","f"],"sourceRoot":""}