"use strict";(self.webpackChunkwanlok_component_react=self.webpackChunkwanlok_component_react||[]).push([[2544],{62544:(e,r,a)=>{a.r(r),a.d(r,{fromUrl:()=>d});var t=a(89379),n=a(50076),l=a(90534),o=a(13096),s=a(39323),i=a(11668),u=a(31933),c=a(62487),y=a(67061);const v={FeatureLayer:!0,SceneLayer:!0};async function d(e){var r;const c=null===(r=e.properties)||void 0===r?void 0:r.customParameters,d=await async function(e,r){let a=(0,o.qg)(e);if(null==a&&(a=await async function(e,r){var a,t;const n=await(0,y.V)(e,{customParameters:r});let s=null,i=null;const u=n.type;if("Feature Layer"===u||"Table"===u?(s="FeatureServer",i=null!==(a=n.id)&&void 0!==a?a:null):"indexedVector"===u?s="VectorTileServer":n.hasOwnProperty("mapName")?s="MapServer":n.hasOwnProperty("bandCount")&&n.hasOwnProperty("pixelSizeX")?s="ImageServer":n.hasOwnProperty("maxRecordCount")&&n.hasOwnProperty("allowGeometryUpdates")?s="FeatureServer":n.hasOwnProperty("streamUrls")?s="StreamServer":p(n)?(s="SceneServer",i=n.id):n.hasOwnProperty("layers")&&p(null===(t=n.layers)||void 0===t?void 0:t[0])&&(s="SceneServer"),!s)return null;const c=null!=i?(0,o.iz)(e):null;return{title:null!=c&&n.name||(0,l.e7)(e),serverType:s,sublayer:i,url:{path:null!=c?c.serviceUrl:(0,l.An)(e).path}}}(e,r)),null==a)throw new n.A("arcgis-layers:url-mismatch","The url '${url}' is not a valid arcgis resource",{url:e});const{serverType:t,sublayer:c}=a;let d;const f={FeatureServer:"FeatureLayer",StreamServer:"StreamLayer",VectorTileServer:"VectorTileLayer"},w="FeatureServer"===t,S="SceneServer"===t,b={parsedUrl:a,Constructor:null,layerId:(w||S)&&null!==c&&void 0!==c?c:void 0,layers:[],tables:[]};switch(t){case"MapServer":d=null!=c?"FeatureLayer":await async function(e,r){return(await(0,y.V)(e,{customParameters:r})).tileInfo}(e,r)?"TileLayer":"MapImageLayer";break;case"ImageServer":{var h;const a=await(0,y.V)(e,{customParameters:r}),{tileInfo:t,cacheType:n}=a;d=t?"LERC"!==(null===t||void 0===t||null===(h=t.format)||void 0===h?void 0:h.toUpperCase())||n&&"elevation"!==n.toLowerCase()?"ImageryTileLayer":"ElevationLayer":"ImageryLayer";break}case"SceneServer":{const e=await(0,y.V)(a.url.path,{customParameters:r});if(d="SceneLayer",e){const r=null===e||void 0===e?void 0:e.layers;if("Voxel"===(null===e||void 0===e?void 0:e.layerType))d="VoxelLayer";else if(null!==r&&void 0!==r&&r.length){var I;const e=null===(I=r[0])||void 0===I?void 0:I.layerType;null!=e&&null!=u.XX[e]&&(d=u.XX[e])}}break}case"3DTilesServer":throw new n.A("arcgis-layers:unsupported","fromUrl() not supported for 3DTiles layers");case"FeatureServer":if(d="FeatureLayer",null!=c){const a=await(0,y.V)(e,{customParameters:r});b.sourceJSON=a,"Oriented Imagery Layer"===a.type&&(d="OrientedImageryLayer")}break;default:d=f[t]}if(v[d]&&null==c){var L;const a=await async function(e,r,a){var t,n;let l,o,u=!1;switch(r){case"FeatureServer":{const r=await(0,i.Q)(e,{customParameters:a});u=!!r.layersJSON,l=r.layersJSON||r.serviceJSON;break}case"SceneServer":{const r=await async function(e,r){var a;const t=await(0,y.V)(e,{customParameters:r}),n=null===(a=t.layers)||void 0===a?void 0:a[0];if(!n)return{serviceInfo:t};try{const{serverUrl:a}=await(0,s.L)(e),n=await(0,y.V)(a,{customParameters:r}).catch((()=>null));return n&&(t.tables=n.tables),{serviceInfo:t,tableServerUrl:a}}catch(l){return{serviceInfo:t}}}(e,a);l=r.serviceInfo,o=r.tableServerUrl;break}default:l=await(0,y.V)(e,{customParameters:a})}const c=null===(t=l)||void 0===t?void 0:t.layers,v=null===(n=l)||void 0===n?void 0:n.tables;return{layers:(null===c||void 0===c?void 0:c.map((e=>({id:e.id}))).reverse())||[],tables:(null===v||void 0===v?void 0:v.map((e=>({serverUrl:o,id:e.id}))).reverse())||[],layerInfos:u?c:[],tableInfos:u?v:[]}}(e,t,r);if(w&&(b.sublayerInfos=a.layerInfos,b.tableInfos=a.tableInfos),1!==a.layers.length+a.tables.length)b.layers=a.layers,b.tables=a.tables,w&&(null===(L=a.layerInfos)||void 0===L?void 0:L.length)&&(b.sublayerConstructorProvider=await async function(e){const r=[],a=[];if(e.forEach((e=>{const{type:t}=e;"Oriented Imagery Layer"===t?(r.push(t),a.push(m("OrientedImageryLayer"))):(r.push(t),a.push(m("FeatureLayer")))})),!a.length)return;const t=await Promise.all(a),n=new Map;return r.forEach(((e,r)=>{n.set(e,t[r])})),e=>n.get(e.type)}(a.layerInfos));else if(w||S){var O,g,P,T,V,C;const e=null!==(O=null===(g=a.layerInfos)||void 0===g?void 0:g[0])&&void 0!==O?O:null===(P=a.tableInfos)||void 0===P?void 0:P[0];b.layerId=null!==(T=null===(V=a.layers[0])||void 0===V?void 0:V.id)&&void 0!==T?T:null===(C=a.tables[0])||void 0===C?void 0:C.id,b.sourceJSON=e,w&&"Oriented Imagery Layer"===(null===e||void 0===e?void 0:e.type)&&(d="OrientedImageryLayer")}}return b.Constructor=await m(d),b}(e.url,c),w=(0,t.A)((0,t.A)({},e.properties),{},{url:e.url});if(d.layers.length+d.tables.length===0)return null!=d.layerId&&(w.layerId=d.layerId),null!=d.sourceJSON&&(w.sourceJSON=d.sourceJSON),new d.Constructor(w);const S=new(0,(await a.e(4604).then(a.bind(a,4604))).default)({title:d.parsedUrl.title});return await async function(e,r,a){function n(e,r,n,l){const o=(0,t.A)((0,t.A)({},a),{},{layerId:r,sublayerTitleMode:"service-name"});return null!=e&&(o.url=e),null!=n&&(o.sourceJSON=n),l(o)}const l=r.sublayerConstructorProvider;for(const{id:t,serverUrl:s}of r.layers){var o;const a=f(r.sublayerInfos,t),i=null!==(o=a&&(null===l||void 0===l?void 0:l(a)))&&void 0!==o?o:r.Constructor,u=n(s,t,a,(e=>new i(e)));e.add(u)}if(r.tables.length){const a=await m("FeatureLayer");r.tables.forEach((t=>{let{id:l,serverUrl:o}=t;const s=n(o,l,f(r.tableInfos,l),(e=>new a(e)));e.tables.add(s)}))}}(S,d,w),S}function f(e,r){return e?e.find((e=>e.id===r)):null}function p(e){return null!=e&&e.hasOwnProperty("store")&&e.hasOwnProperty("id")&&"number"==typeof e.id}async function m(e){return(0,c.S[e])()}},11668:(e,r,a)=>{a.d(r,{Q:()=>o});var t=a(80045),n=a(67061);const l=["loadContext"];async function o(e,r){var a;const o=r||{},{loadContext:s}=o,i=(0,t.A)(o,l),c=s?await s.fetchServiceMetadata(e,i):await(0,n.V)(e,i);v(c),u(c);const y={serviceJSON:c};if((null!==(a=c.currentVersion)&&void 0!==a?a:0)<10.5)return y;const d="".concat(e,"/layers"),f=s?await s.fetchServiceMetadata(d,i):await(0,n.V)(d,i);return v(f),u(f),y.layersJSON={layers:f.layers,tables:f.tables},y}function s(e){return"Feature Layer"===e.type||"Oriented Imagery Layer"===e.type}function i(e){return"Table"===e.type}function u(e){var r,a;e.layers=null===(r=e.layers)||void 0===r?void 0:r.filter(s),e.tables=null===(a=e.tables)||void 0===a?void 0:a.filter(i)}function c(e){e.type||(e.type="Feature Layer")}function y(e){e.type||(e.type="Table")}function v(e){var r,a;null!==(r=e.layers)&&void 0!==r&&r.forEach(c),null===(a=e.tables)||void 0===a||a.forEach(y)}},67061:(e,r,a)=>{a.d(r,{V:()=>l});var t=a(89379),n=a(3825);async function l(e,r){const{data:a}=await(0,n.A)(e,{responseType:"json",query:(0,t.A)((0,t.A)({f:"json"},null===r||void 0===r?void 0:r.customParameters),{},{token:null===r||void 0===r?void 0:r.apiKey})});return a}}}]);
//# sourceMappingURL=2544.70d4fbec.chunk.js.map