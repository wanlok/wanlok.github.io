{"version":3,"file":"static/js/5556.e45fcb55.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/views/layers/ImageryLayerView.js","../node_modules/@arcgis/core/views/3d/layers/ImageryLayerView3D.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.29/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import t from\"../../core/Error.js\";import{throwIfAborted as r}from\"../../core/promiseUtils.js\";import{property as o}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as s}from\"../../core/accessorSupport/decorators/subclass.js\";import p from\"../../geometry/Point.js\";import{combinedViewLayerTimeExtentProperty as i}from\"../../layers/support/commonProperties.js\";import a from\"../../rest/support/Query.js\";import{getFetchPopupTemplate as n}from\"./support/popupUtils.js\";const u=u=>{let m=class extends u{constructor(){super(...arguments),this.view=null}async fetchPopupFeaturesAtLocation(e,o){const{layer:s}=this;if(!e)throw new t(\"imagerylayerview:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:s});const{popupEnabled:i}=s,u=n(s,o);if(!i||null==u)throw new t(\"imagerylayerview:fetchPopupFeatures\",\"Missing required popupTemplate or popupEnabled\",{popupEnabled:i,popupTemplate:u});const m=await u.getRequiredFields();r(o);const c=new a;c.timeExtent=this.timeExtent,c.geometry=e,c.outFields=m,c.outSpatialReference=e.spatialReference;const{resolution:l,spatialReference:y}=this.view,d=\"2d\"===this.view.type?new p(l,l,y):new p(.5*l,.5*l,y),{returnTopmostRaster:h,showNoDataRecords:w}=u.layerOptions||{returnTopmostRaster:!0,showNoDataRecords:!1},f={returnDomainValues:!0,returnTopmostRaster:h,pixelSize:d,showNoDataRecords:w,signal:o?.signal};return s.queryVisibleRasters(c,f).then((e=>e))}canResume(){return!!super.canResume()&&!this.timeExtent?.isEmpty}};return e([o()],m.prototype,\"layer\",void 0),e([o()],m.prototype,\"suspended\",void 0),e([o(i)],m.prototype,\"timeExtent\",void 0),e([o()],m.prototype,\"view\",void 0),m=e([s(\"esri.views.layers.ImageryLayerView\")],m),m};export{u as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.29/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import{debounce as a}from\"../../../core/promiseUtils.js\";import{when as t}from\"../../../core/reactiveUtils.js\";import\"../../../core/Logger.js\";import\"../../../core/has.js\";import\"../../../core/RandomLCG.js\";import\"../../../core/Error.js\";import{subclass as i}from\"../../../core/accessorSupport/decorators/subclass.js\";import r from\"./DynamicLayerView3D.js\";import s from\"../../layers/ImageryLayerView.js\";let n=class extends(s(r)){constructor(){super(...arguments),this.type=\"imagery-3d\",this.redrawDebounced=a((async e=>{this.redraw(((e,a)=>this._redrawImage(e,a)),e)}),2e3)}initialize(){this.addHandles([t((()=>this.view.basemapTerrain.ready),(()=>this._initializeMaximumDataResolution()),{once:!0,initial:!0}),this.layer.on(\"redraw\",(()=>this._updatingHandles.addPromise(this.redrawDebounced())))]),this._updatingHandles.add((()=>this.layer?.exportImageServiceParameters?.version),(()=>{this._updatingHandles.addPromise(this.refreshDebounced())})),this._updatingHandles.add((()=>this.layer?.renderer),(()=>{this._updatingHandles.addPromise(this.refreshDebounced())})),this._updatingHandles.add((()=>this.timeExtent),(()=>this._updatingHandles.addPromise(this.refreshDebounced())))}_initializeMaximumDataResolution(){this.maximumDataResolution=this.layer.loaded?this.layer.serviceRasterInfo.pixelSize:null}getFetchOptions(){return{timeExtent:this.timeExtent}}async processResult(e,a,t){a.imageOrCanvasElement?e.image=a.imageOrCanvasElement:(e.image=document.createElement(\"canvas\"),e.pixelData=a.pixelData,await this._redrawImage(e,t))}async _redrawImage(e,a){if(!(e.image instanceof HTMLCanvasElement)||null==e.pixelData)throw new Error;const t=e.image,i=t.getContext(\"2d\"),r=await this.layer.applyRenderer(e.pixelData,{signal:a}),s=this.layer.applyFilter(r).pixelBlock;if(null==s)throw new Error;t.width=s.width,t.height=s.height;const n=i.createImageData(s.width,s.height);n.data.set(s.getAsRGBA()),i.putImageData(n,0,0)}};n=e([i(\"esri.views.3d.layers.ImageryLayerView3D\")],n);const o=n;export{o as default};\n"],"names":["u","m","constructor","super","arguments","this","view","fetchPopupFeaturesAtLocation","e","o","layer","s","t","popupEnabled","i","n","popupTemplate","getRequiredFields","r","c","a","timeExtent","geometry","outFields","outSpatialReference","spatialReference","resolution","l","y","d","type","p","returnTopmostRaster","h","showNoDataRecords","w","layerOptions","f","returnDomainValues","pixelSize","signal","queryVisibleRasters","then","canResume","_this$timeExtent","isEmpty","prototype","redrawDebounced","async","redraw","_redrawImage","initialize","addHandles","basemapTerrain","ready","_initializeMaximumDataResolution","once","initial","on","_updatingHandles","addPromise","add","_this$layer","exportImageServiceParameters","version","refreshDebounced","_this$layer2","renderer","maximumDataResolution","loaded","serviceRasterInfo","getFetchOptions","processResult","imageOrCanvasElement","image","document","createElement","pixelData","HTMLCanvasElement","Error","getContext","applyRenderer","applyFilter","pixelBlock","width","height","createImageData","data","set","getAsRGBA","putImageData"],"sourceRoot":""}