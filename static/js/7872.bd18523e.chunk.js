"use strict";(self.webpackChunkwanlok_component_react=self.webpackChunkwanlok_component_react||[]).push([[7872],{95491:(t,e,r)=>{r.d(e,{A:()=>v});var n=r(35143),o=r(91967),i=r(50076),a=r(81806),s=r(50346),u=r(90534),l=r(46053),c=(r(76460),r(47249),r(85842)),d=r(19463),h=r(89551),f=r(54994),y=r(37713),p=r(89379),m=(r(35238),r(36643)),_=r(97015),S=r(76797);var g=r(53104),x=r(14009),b=r(78469),F=r(77725);let O=class extends o.A{constructor(t){super(t),this.dynamicDataSource=null,this.fieldsIndex=null,this.gdbVersion=null,this.infoFor3D=null,this.pbfSupported=!1,this.queryAttachmentsSupported=!1,this.sourceSpatialReference=null,this.url=null}get parsedUrl(){return(0,u.An)(this.url)}async execute(t,e){const r=await this.executeJSON(t,e);return this.featureSetFromJSON(t,r,e)}async executeJSON(t,e){var r;const n=this._normalizeQuery(t),o=null!=(null===(r=t.outStatistics)||void 0===r?void 0:r[0]),i=(0,a.A)("featurelayer-pbf-statistics"),s=!o||i;let u;if(this.pbfSupported&&s)try{u=await(0,b.S)(this.url,n,e)}catch(l){if("query:parsing-pbf"!==l.name)throw l;this.pbfSupported=!1}return this.pbfSupported&&s||(u=await(0,x.e)(this.url,n,e)),this._normalizeFields(u.fields),u}async featureSetFromJSON(t,e,n){if(!this._queryIs3DObjectFormat(t)||null==this.infoFor3D||!e.features)return F.A.fromJSON(e);const{meshFeatureSetFromJSON:o}=await(0,s.qr)(r.e(156).then(r.bind(r,10156)),n);return o(t,this.infoFor3D,e)}executeForCount(t,e){return(0,y.I)(this.url,this._normalizeQuery(t),e)}executeForExtent(t,e){return async function(t,e,r){const n=(0,f.Dl)(t),o=await(0,m.Jf)(n,_.A.from(e),(0,p.A)({},r)),i=o.data.extent;return!i||isNaN(i.xmin)||isNaN(i.ymin)||isNaN(i.xmax)||isNaN(i.ymax)?{count:o.data.count,extent:null}:{count:o.data.count,extent:S.A.fromJSON(i)}}(this.url,this._normalizeQuery(t),e)}executeForIds(t,e){return(0,g.V)(this.url,this._normalizeQuery(t),e)}async executeRelationshipQuery(t,e){const[{default:n},{executeRelationshipQuery:o}]=await(0,s.qr)(Promise.all([Promise.resolve().then(r.bind(r,58289)),r.e(9437).then(r.bind(r,69437))]),e);return t=n.from(t),(this.gdbVersion||this.dynamicDataSource)&&((t=t.clone()).gdbVersion=t.gdbVersion||this.gdbVersion,t.dynamicDataSource=t.dynamicDataSource||this.dynamicDataSource),o(this.url,t,e)}async executeRelationshipQueryForCount(t,e){const[{default:n},{executeRelationshipQueryForCount:o}]=await(0,s.qr)(Promise.all([Promise.resolve().then(r.bind(r,58289)),r.e(9437).then(r.bind(r,69437))]),e);return t=n.from(t),(this.gdbVersion||this.dynamicDataSource)&&((t=t.clone()).gdbVersion=t.gdbVersion||this.gdbVersion,t.dynamicDataSource=t.dynamicDataSource||this.dynamicDataSource),o(this.url,t,e)}async executeAttachmentQuery(t,e){const{executeAttachmentQuery:n,fetchAttachments:o,processAttachmentQueryResult:i}=await(0,s.qr)(r.e(5297).then(r.bind(r,55297)),e),a=(0,f.Dl)(this.url);return i(a,await(this.queryAttachmentsSupported?n(a,t,e):o(a,t,e)))}async executeTopFeaturesQuery(t,e){const{executeTopFeaturesQuery:n}=await(0,s.qr)(r.e(6244).then(r.bind(r,63863)),e);return n(this.parsedUrl,t,this.sourceSpatialReference,e)}async executeForTopIds(t,e){const{executeForTopIds:n}=await(0,s.qr)(r.e(9119).then(r.bind(r,69119)),e);return n(this.parsedUrl,t,e)}async executeForTopExtents(t,e){const{executeForTopExtents:n}=await(0,s.qr)(r.e(2520).then(r.bind(r,12520)),e);return n(this.parsedUrl,t,e)}async executeForTopCount(t,e){const{executeForTopCount:n}=await(0,s.qr)(r.e(6406).then(r.bind(r,36406)),e);return n(this.parsedUrl,t,e)}_normalizeQuery(t){let e=_.A.from(t);e.sourceSpatialReference=e.sourceSpatialReference||this.sourceSpatialReference,(this.gdbVersion||this.dynamicDataSource)&&(e=e===t?e.clone():e,e.gdbVersion=t.gdbVersion||this.gdbVersion,e.dynamicDataSource=t.dynamicDataSource?h.L.from(t.dynamicDataSource):this.dynamicDataSource);const{infoFor3D:r}=this;if(null!=r&&this._queryIs3DObjectFormat(t)){var n,o;e=e===t?e.clone():e,e.formatOf3DObjects=null;const{supportedFormats:a,queryFormats:s}=r,u=null!==(n=(0,d.R_)("model/gltf-binary",a))&&void 0!==n?n:(0,d.E1)("glb",a),l=null!==(o=(0,d.R_)("model/gltf+json",a))&&void 0!==o?o:(0,d.E1)("gltf",a);for(const t of s){if(t===u){e.formatOf3DObjects=t;break}t!==l||e.formatOf3DObjects||(e.formatOf3DObjects=t)}if(!e.formatOf3DObjects)throw new i.A("query:unsupported-3d-query-formats","Could not find any supported 3D object query format. Only supported formats are 3D_glb and 3D_gltf");if(null==e.outFields||!e.outFields.includes("*")){e=e===t?e.clone():e,null==e.outFields&&(e.outFields=[]);const{originX:n,originY:o,originZ:i,translationX:a,translationY:s,translationZ:u,scaleX:l,scaleY:c,scaleZ:d,rotationX:h,rotationY:f,rotationZ:y,rotationDeg:p}=r.transformFieldRoles;e.outFields.push(n,o,i,a,s,u,l,c,d,h,f,y,p)}}return e}_normalizeFields(t){if(null!=this.fieldsIndex&&null!=t)for(const e of t){const t=this.fieldsIndex.get(e.name);t&&Object.assign(e,t.toJSON())}}_queryIs3DObjectFormat(t){return null!=this.infoFor3D&&!0===t.returnGeometry&&"xyFootprint"!==t.multipatchOption&&!t.outStatistics}};(0,n._)([(0,l.MZ)({type:h.L})],O.prototype,"dynamicDataSource",void 0),(0,n._)([(0,l.MZ)()],O.prototype,"fieldsIndex",void 0),(0,n._)([(0,l.MZ)()],O.prototype,"gdbVersion",void 0),(0,n._)([(0,l.MZ)()],O.prototype,"infoFor3D",void 0),(0,n._)([(0,l.MZ)({readOnly:!0})],O.prototype,"parsedUrl",null),(0,n._)([(0,l.MZ)()],O.prototype,"pbfSupported",void 0),(0,n._)([(0,l.MZ)()],O.prototype,"queryAttachmentsSupported",void 0),(0,n._)([(0,l.MZ)()],O.prototype,"sourceSpatialReference",void 0),(0,n._)([(0,l.MZ)({type:String})],O.prototype,"url",void 0),O=(0,n._)([(0,c.$)("esri.tasks.QueryTask")],O);const v=O},78238:(t,e,r)=>{function n(t){const e={};for(const r in t){if("declaredClass"===r)continue;const o=t[r];if(null!=o&&"function"!=typeof o)if(Array.isArray(o)){e[r]=[];for(let t=0;t<o.length;t++)e[r][t]=n(o[t])}else"object"==typeof o?o.toJSON&&(e[r]=JSON.stringify(o)):e[r]=o}return e}r.d(e,{z:()=>n})},37713:(t,e,r)=>{r.d(e,{I:()=>s});var n=r(89379),o=r(54994),i=r(36643),a=r(97015);async function s(t,e,r){const s=(0,o.Dl)(t);return(0,i.gW)(s,a.A.from(e),(0,n.A)({},r)).then((t=>t.data.count))}},53104:(t,e,r)=>{r.d(e,{V:()=>s});var n=r(89379),o=r(54994),i=r(36643),a=r(97015);async function s(t,e,r){const s=(0,o.Dl)(t);return(0,i.Pk)(s,a.A.from(e),(0,n.A)({},r)).then((t=>t.data.objectIds))}},14009:(t,e,r)=>{r.d(e,{e:()=>l,s:()=>u});var n=r(89379),o=r(54994),i=r(36643),a=r(77725),s=r(97015);async function u(t,e,r){const n=await l(t,e,r);return a.A.fromJSON(n)}async function l(t,e,r){const a=(0,o.Dl)(t),u=(0,n.A)({},r),l=s.A.from(e),{data:c}=await(0,i.eW)(a,l,l.sourceSpatialReference,u);return c}},78469:(t,e,r)=>{r.d(e,{S:()=>_});var n=r(89379),o=r(54994),i=r(30726),a=r(86729),s=r(98618);function u(t,e){return e}function l(t,e,r,n){switch(r){case 0:return f(t,e+n,0);case 1:return"lowerLeft"===t.originPosition?f(t,e+n,1):function(t,e,r){let{translate:n,scale:o}=t;return n[r]-e*o[r]}(t,e+n,1)}}function c(t,e,r,n){return 2===r?f(t,e,2):l(t,e,r,n)}function d(t,e,r,n){return 2===r?0===e?0:f(t,e,3):l(t,e,r,n)}function h(t,e,r,n){return 3===r?0===e?0:f(t,e,3):c(t,e,r,n)}function f(t,e,r){let{translate:n,scale:o}=t;return n[r]+e*o[r]}class y{constructor(t){this._options=t,this.geometryTypes=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"],this._previousCoordinate=[0,0],this._transform=null,this._applyTransform=u,this._lengths=[],this._currentLengthIndex=0,this._toAddInCurrentPath=0,this._vertexDimension=0,this._mValueOffset=null,this._coordinateBuffer=null,this._coordinateBufferPtr=0,this._attributesConstructor=class{}}createFeatureResult(){return{fields:[],features:[]}}finishFeatureResult(t){if(this._options.applyTransform&&(t.transform=null),this._attributesConstructor=class{},this._coordinateBuffer=null,this._lengths.length=0,!t.hasZ)return;const e=(0,a.N)(t.geometryType,this._options.sourceSpatialReference,t.spatialReference);if(null!=e)for(const r of t.features)e(r.geometry)}createSpatialReference(){return{}}addField(t,e){const r=t.fields;(0,i.Lw)(r),r.push(e);const n=r.map((t=>t.name));this._attributesConstructor=function(){for(const t of n)this[t]=null}}addFeature(t,e){t.features.push(e)}prepareFeatures(t){switch(this._transform=t.transform,this._options.applyTransform&&t.transform&&(this._applyTransform=this._deriveApplyTransform(t)),this._mValueOffset=null,this._vertexDimension=2,t.hasZ&&this._vertexDimension++,t.hasM&&(this._mValueOffset=this._vertexDimension,this._vertexDimension++),t.geometryType){case"esriGeometryPoint":this.addCoordinate=(t,e,r)=>this.addCoordinatePoint(t,e,r),this.createGeometry=t=>this.createPointGeometry(t);break;case"esriGeometryPolygon":this.addCoordinate=(t,e,r)=>this._addCoordinatePolygon(t,e,r),this.createGeometry=t=>this._createPolygonGeometry(t);break;case"esriGeometryPolyline":this.addCoordinate=(t,e,r)=>this._addCoordinatePolyline(t,e,r),this.createGeometry=t=>this._createPolylineGeometry(t);break;case"esriGeometryMultipoint":this.addCoordinate=(t,e,r)=>this._addCoordinateMultipoint(t,e,r),this.createGeometry=t=>this._createMultipointGeometry(t)}}createFeature(){return this._lengths.length=0,this._currentLengthIndex=0,this._previousCoordinate[0]=0,this._previousCoordinate[1]=0,this._coordinateBuffer=null,this._coordinateBufferPtr=0,{attributes:new this._attributesConstructor}}allocateCoordinates(){}addLength(t,e,r){0===this._lengths.length&&(this._toAddInCurrentPath=e),this._lengths.push(e)}addQueryGeometry(t,e){const{queryGeometry:r,queryGeometryType:o}=e,i=(0,s.Ch)(r.clone(),r,!1,!1,this._transform),a=(0,s.zv)(i,o,!1,!1);t.queryGeometryType=o,t.queryGeometry=(0,n.A)({},a)}createPointGeometry(t){const e={x:0,y:0,spatialReference:t.spatialReference};return t.hasZ&&(e.z=0),t.hasM&&(e.m=0),e}addCoordinatePoint(t,e,r){const n=this._transform;switch(e=this._applyTransform(n,e,r,0),r){case 0:t.x=e;break;case 1:t.y=e;break;case 2:"z"in t?t.z=e:t.m=e;break;case 3:t.m=e}}_transformPathLikeValue(t,e){let r=0;e<=1&&(r=this._previousCoordinate[e],this._previousCoordinate[e]+=t);const n=this._transform;return null===this._mValueOffset||0!==t||e%this._mValueOffset?this._applyTransform(n,t,e,r):0}_addCoordinatePolyline(t,e,r){this._dehydratedAddPointsCoordinate(t.paths,e,r)}_addCoordinatePolygon(t,e,r){this._dehydratedAddPointsCoordinate(t.rings,e,r)}_addCoordinateMultipoint(t,e,r){0===r&&t.points.push([]);const n=this._transformPathLikeValue(e,r);t.points[t.points.length-1].push(n)}_createPolygonGeometry(t){return{rings:[[]],spatialReference:t.spatialReference,hasZ:!!t.hasZ,hasM:!!t.hasM}}_createPolylineGeometry(t){return{paths:[[]],spatialReference:t.spatialReference,hasZ:!!t.hasZ,hasM:!!t.hasM}}_createMultipointGeometry(t){return{points:[],spatialReference:t.spatialReference,hasZ:!!t.hasZ,hasM:!!t.hasM}}_dehydratedAddPointsCoordinate(t,e,r){0===r&&0==this._toAddInCurrentPath--&&(t.push([]),this._toAddInCurrentPath=this._lengths[++this._currentLengthIndex]-1,this._previousCoordinate[0]=0,this._previousCoordinate[1]=0);const n=this._transformPathLikeValue(e,r),o=t[t.length-1];0===r&&(this._coordinateBufferPtr=0,this._coordinateBuffer=new Array(this._vertexDimension),o.push(this._coordinateBuffer)),this._coordinateBuffer[this._coordinateBufferPtr++]=n}_deriveApplyTransform(t){const{hasZ:e,hasM:r}=t;return e&&r?h:e?c:r?d:l}}var p=r(36643),m=(r(77725),r(97015));async function _(t,e,r){const i=(0,o.Dl)(t),a=(0,n.A)({},r),s=m.A.from(e),u=!s.quantizationParameters,{data:l}=await(0,p.IJ)(i,s,new y({sourceSpatialReference:s.sourceSpatialReference,applyTransform:u}),a);return l}},36643:(t,e,r)=>{r.d(e,{GB:()=>x,IJ:()=>p,Jf:()=>g,Pk:()=>_,eW:()=>y,gW:()=>S,kS:()=>m});var n=r(89379),o=r(3825),i=r(90534),a=r(19902),s=r(1438),u=r(80963),l=r(78238),c=r(89122),d=r(57831);const h="Layer does not support extent calculation.";function f(t,e){var r;const n=t.geometry,o=t.toJSON();delete o.compactGeometryEnabled,delete o.defaultSpatialReferenceEnabled;const i=o;let s,l,c;if(null!=n&&(l=n.spatialReference,c=(0,u.YX)(l),i.geometryType=(0,a.$B)(n),i.geometry=function(t,e){if(e&&"extent"===t.type)return"".concat(t.xmin,",").concat(t.ymin,",").concat(t.xmax,",").concat(t.ymax);if(e&&"point"===t.type)return"".concat(t.x,",").concat(t.y);const r=t.toJSON();return delete r.spatialReference,JSON.stringify(r)}(n,t.compactGeometryEnabled),i.inSR=c),o.groupByFieldsForStatistics&&(i.groupByFieldsForStatistics=o.groupByFieldsForStatistics.join(",")),o.objectIds&&(i.objectIds=o.objectIds.join(",")),o.orderByFields&&(i.orderByFields=o.orderByFields.join(",")),!o.outFields||!o.returnDistinctValues&&(null!==e&&void 0!==e&&e.returnCountOnly||null!==e&&void 0!==e&&e.returnExtentOnly||null!==e&&void 0!==e&&e.returnIdsOnly)?delete i.outFields:o.outFields.includes("*")?i.outFields="*":i.outFields=o.outFields.join(","),o.outSR?(i.outSR=(0,u.YX)(o.outSR),s=t.outSpatialReference):n&&(o.returnGeometry||o.returnCentroid)&&(i.outSR=i.inSR,s=l),o.returnGeometry&&delete o.returnGeometry,o.outStatistics&&(i.outStatistics=JSON.stringify(o.outStatistics)),o.fullText&&(i.fullText=JSON.stringify(o.fullText)),o.pixelSize&&(i.pixelSize=JSON.stringify(o.pixelSize)),o.quantizationParameters&&(t.defaultSpatialReferenceEnabled&&null!=l&&null!=(null===(r=t.quantizationParameters)||void 0===r?void 0:r.extent)&&l.equals(t.quantizationParameters.extent.spatialReference)&&delete o.quantizationParameters.extent.spatialReference,i.quantizationParameters=JSON.stringify(o.quantizationParameters)),o.parameterValues&&(i.parameterValues=JSON.stringify(o.parameterValues)),o.rangeValues&&(i.rangeValues=JSON.stringify(o.rangeValues)),o.dynamicDataSource&&(i.layer=JSON.stringify({source:o.dynamicDataSource}),delete o.dynamicDataSource),o.timeExtent){const t=o.timeExtent,{start:e,end:r}=t;null==e&&null==r||(i.time=e===r?e:"".concat(null!==e&&void 0!==e?e:"null",",").concat(null!==r&&void 0!==r?r:"null")),delete o.timeExtent}return t.defaultSpatialReferenceEnabled&&null!=l&&null!=s&&l.equals(s)&&(i.defaultSR=i.inSR,delete i.inSR,delete i.outSR),i}async function y(t,e,r,n){const o=null!=e.timeExtent&&e.timeExtent.isEmpty?{data:{features:[]}}:await x(t,e,"json",n);return(0,d.q)(e,r,o.data),o}async function p(t,e,r,n){if(null!=e.timeExtent&&e.timeExtent.isEmpty)return{data:r.createFeatureResult()};const o=await m(t,e,n),i=o;return i.data=(0,c.m)(o.data,r),i}function m(t,e,r){return x(t,e,"pbf",r)}function _(t,e,r){return null!=e.timeExtent&&e.timeExtent.isEmpty?Promise.resolve({data:{objectIds:[]}}):x(t,e,"json",r,{returnIdsOnly:!0})}function S(t,e,r){return null!=e.timeExtent&&e.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):x(t,e,"json",r,{returnIdsOnly:!0,returnCountOnly:!0})}async function g(t,e,r){if(null!=e.timeExtent&&e.timeExtent.isEmpty)return{data:{count:0,extent:null}};const n=await x(t,e,"json",r,{returnExtentOnly:!0,returnCountOnly:!0}),o=n.data;if(o.hasOwnProperty("extent"))return n;if(o.features)throw new Error(h);if(o.hasOwnProperty("count"))throw new Error(h);return n}async function x(t,e,r){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const c="string"==typeof t?(0,i.An)(t):t,d=e.geometry?[e.geometry]:[],h=await(0,s.el)(d,null,{signal:a.signal}),y=null===h||void 0===h?void 0:h[0];null!=y&&((e=e.clone()).geometry=y);const p=(0,l.z)((0,n.A)((0,n.A)((0,n.A)({},c.query),{},{f:r},u),f(e,u)));return(0,o.A)((0,i.fj)(c.path,(m=u,null==e.formatOf3DObjects||m.returnCountOnly||m.returnExtentOnly||m.returnIdsOnly?"query":"query3d")),(0,n.A)((0,n.A)({},a),{},{responseType:"pbf"===r?"array-buffer":"json",query:(0,n.A)((0,n.A)({},p),a.query)}));var m}}}]);
//# sourceMappingURL=7872.bd18523e.chunk.js.map