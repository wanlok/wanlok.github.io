"use strict";(self.webpackChunkwanlok_component_react=self.webpackChunkwanlok_component_react||[]).push([[4063],{94063:(t,r,e)=>{e.r(r),e.d(r,{default:()=>m});var a=e(18690),n=e(78393),o=e(60008),f=e(4336),u=e(20664),s=e(83755),i=e(13312),l=e(45308),b=e(71869),c=e(59231);class p{transform(t){const r=this._transform(t),e=[r.points.buffer,r.rgb.buffer];null!=r.pointIdFilterMap&&e.push(r.pointIdFilterMap.buffer);for(const a of r.attributes)"buffer"in a.values&&(0,n.mw)(a.values.buffer)&&a.values.buffer!==r.rgb.buffer&&e.push(a.values.buffer);return Promise.resolve({result:r,transferList:e})}_transform(t){const r=(0,b.RC)(t.schema,t.geometryBuffer);let e=r.length/3,n=null;const o=new Array,f=(0,b.jy)(t.primaryAttributeData,r,e);null!=t.primaryAttributeData&&f&&o.push({attributeInfo:t.primaryAttributeData.attributeInfo,values:f});const u=(0,b.jy)(t.modulationAttributeData,r,e);null!=t.modulationAttributeData&&u&&o.push({attributeInfo:t.modulationAttributeData.attributeInfo,values:u});let s=(0,b.bh)(t.rendererInfo,f,u,e);if(t.filterInfo&&t.filterInfo.length>0&&null!=t.filterAttributesData){const f=t.filterAttributesData.filter(a.Ru).map((t=>{const a=(0,b.jy)(t,r,e),n={attributeInfo:t.attributeInfo,values:a};return o.push(n),n}));n=new Uint32Array(e),e=(0,b.$i)(r,s,n,t.filterInfo,f)}for(const a of t.userAttributesData){const t=(0,b.jy)(a,r,e);o.push({attributeInfo:a.attributeInfo,values:t})}3*e<s.length&&(s=new Uint8Array(s.buffer.slice(0,3*e))),this._applyElevationOffsetInPlace(r,e,t.elevationOffset);const l=this._transformCoordinates(r,e,c.ab.fromData(t.obbData),i.A.fromJSON(t.inSR),i.A.fromJSON(t.outSR));return{obbData:t.obbData,points:l,rgb:s,attributes:o,pointIdFilterMap:n}}_transformCoordinates(t,r,e,a,n){if(!(0,l.projectBuffer)(t,a,0,t,n,0,r))throw new Error("Can't reproject");const f=(0,s.o8)(e.center),i=(0,s.vt)(),b=(0,s.vt)(),c=(0,s.o8)(e.halfSize);(0,o.Xr)(h,e.quaternion);const p=new Float32Array(3*r);for(let o=0;o<r;o++){let r=3*o;i[0]=t[r]-f[0],i[1]=t[r+1]-f[1],i[2]=t[r+2]-f[2],(0,u.u)(b,i,h),c[0]=Math.max(c[0],Math.abs(b[0])),c[1]=Math.max(c[1],Math.abs(b[1])),c[2]=Math.max(c[2],Math.abs(b[2])),p[r++]=i[0],p[r++]=i[1],p[r]=i[2]}return e.halfSize=c,p}_applyElevationOffsetInPlace(t,r,e){if(0!==e)for(let a=0;a<r;a++)t[3*a+2]+=e}}const h=(0,f.vt)();function m(){return new p}}}]);
//# sourceMappingURL=4063.78bd5bb1.chunk.js.map